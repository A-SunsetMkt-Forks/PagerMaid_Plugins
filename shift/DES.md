# 智能转发助手（shift 模块）

## 📌 插件简介

该插件为 PagerMaid 添加了 **智能转发与消息备份** 功能，支持自动转发频道、群组、私聊消息到目标对话，并支持关键词过滤、消息类型筛选、多级转发、统计分析等高级功能。

适合需要自动同步频道消息、跨群备份、或多层级信息流转的场景。

---

## ⚙ 功能概览

* **转发规则管理**

  * 新建、删除、暂停、恢复转发规则
  * 支持多种消息类型筛选（文本、图片、视频、音频等）
  * 支持静音转发
* **关键词过滤**

  * 添加/删除过滤关键词
  * 按关键词屏蔽消息转发
* **多级转发**

  * 自动检测并执行链式转发（源→目标→下一级目标）
* **历史消息备份**

  * 一次性批量备份历史消息
* **数据统计**

  * 按天统计转发数量
  * 查看近 7 天的每日转发量
* **循环检测**

  * 防止直接或间接循环转发

---

## 📝 命令说明

### 1. 基础命令

```
shift set [源] [目标] [选项...]
```

创建转发规则。

* **源**：消息来源（可用 `here` 表示当前会话）
* **目标**：消息接收方
* **选项**：`silent`, `text`, `photo`, `document`, `video`, `sticker`, `animation`, `voice`, `audio`, `all`

示例：

```
shift set @channel1 @channel2 silent photo
```

---

```
shift del [序号]
```

删除指定序号的转发规则（序号可用逗号分隔）。

---

```
shift list
```

查看所有转发规则及其状态。

---

```
shift pause [序号]
shift resume [序号]
```

暂停/恢复转发规则。

---

```
shift backup [源] [目标] [选项...]
```

将源对话的历史消息批量转发到目标对话。

---

```
shift filter [序号] add [关键词...]
shift filter [序号] del [关键词...]
shift filter [序号] list
```

管理规则的过滤关键词。

---

```
shift stats
```

查看转发统计（总量及近 7 天每日数量）。

---

## 🎯 支持的目标类型

* **频道/群组**：`@username` 或 `-100...ID`
* **个人用户**：`@username` 或 `user_id`
* **当前对话**：`me` 或 `here`

---

## 🛡 消息类型选项

* `silent`：静音转发
* `text`：文本
* `photo`：图片
* `document`：文档
* `video`：视频
* `sticker`：贴纸
* `animation`：动图
* `voice`：语音
* `audio`：音频
* `all`：全部类型

---

## 🔍 高级特性

* **循环检测**：防止无限转发
* **多级转发**：自动执行链式转发
* **过滤机制**：关键词过滤，按需阻止消息
* **统计分析**：每日与总量数据
* **权限检测**：自动移除失效规则（如内容保护、无写入权限等）

---

## ⚠ 注意事项

1. **防 Flood 限制**：插件遇到 FloodWait 会自动等待并重试。
2. **内容保护**：源对话开启内容保护（`noforwards`）时，规则会被删除。
3. **深度限制**：多级转发最大深度为 5 层，防止循环与性能问题。
4. **消息过滤**：过滤关键词不区分大小写。


